(self.webpackChunkspace=self.webpackChunkspace||[]).push([[610],{60405:function(e,t,n){"use strict";function o(e={}){let t="https://github.com/login/oauth/authorize",n="user",o="https://github.com/login/oauth/access_token",c="6d1f0f1a67b21e729050",r="22cbbe70c70edb70097236f0b8e51c46b8ac460e",i="http://message.xiongxiao.me/cors/",s="http://message.xiongxiao.me/api/gitThinkToken",a=!1;e.authorizeUrl&&(t=e.authorizeUrl),e.scope&&(n=e.scope),e.accessTokenUrl&&(o=e.accessTokenUrl),e.client_id&&(c=e.client_id),e.client_secret&&(r=e.client_secret),e.proxyUrl&&(i=e.proxyUrl),e.queryUrl&&(s=e.queryUrl),e.useQueryUrl&&(a=e.useQueryUrl);const u="xx-space-",l="token",f="access_token";function h(){location.href=t+"?client_id="+c+"&scope="+n}function d(e,t){localStorage.setItem(u+e,t)}function p(e){localStorage.removeItem(u+e)}function g(e,t){var n=window.location.search.substring(1);null!=t&&(n=t);for(var o=n.split("&"),c=0;c<o.length;c++){var r=o[c].split("=");if(r[0]==e)return r[1]}return!1}function m(e){if(!/access_token/.test(e))return alert("登录错误"),void k();d(f,e),d(l,g("access_token",e))}function k(){p(f),p(l)}function _(){return e=l,localStorage.getItem(u+e);var e}async function y(){return r&&!a?async function(){let e=g("code"),t={client_id:c,client_secret:r,code:e};if(e){const e=await fetch(i+o,{method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"},mode:"cors"});return m(await e.text()),_()}}():async function(){let e=g("code"),t={client_id:c,client_secret:r,code:e};if(e){const e=await fetch(s,{method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"},mode:"cors"});return m(await e.text()),_()}}()}function x(){return!!g("code")}function v(){return!!_()}return{login:h,isNext:x,next:y,getToken:_,hasToken:v,logout:k,auto:function(){if(v())return Promise.resolve(_());if(x()){return y()}return h(),Promise.resolve("登录页面")}}}n.d(t,{O:function(){return o}})},61610:function(e,t,n){"use strict";n.r(t);n(74916),n(4723);var o=n(74803),c=n(97076),r=n(20718),i=n(67294),s=n(16550),a=n(60405),u=(0,r.Pi)((function(){var e=(0,o.m)().userStore,t=(0,s.k6)();function n(){var n;n=location.href.match(/localhost/)?e.client_id_local:e.client_id;var o=(0,a.O)({proxyUrl:"http://message.xiongxiao.me/cors/",client_id:n});o.auto().then((function(n){var c=o.getToken();c&&(e.setToken(c),t.push("/"))}))}return(0,c.Z)((function(){n()})),window.postCode=n,i.createElement("div",null,i.createElement("a",{onClick:n},"若没有自动跳转，请手动点击登录"))}));t.default=u}}]);