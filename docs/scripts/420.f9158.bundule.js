(self.webpackChunkspace=self.webpackChunkspace||[]).push([[420],{60405:function(e,t,n){"use strict";function o(e={}){let t="https://github.com/login/oauth/authorize",n="user",o="https://github.com/login/oauth/access_token",c="6d1f0f1a67b21e729050",i="22cbbe70c70edb70097236f0b8e51c46b8ac460e",r="http://message.xiongxiao.me/cors/",s="http://message.xiongxiao.me/api/gitThinkToken",a=!1;e.authorizeUrl&&(t=e.authorizeUrl),e.scope&&(n=e.scope),e.accessTokenUrl&&(o=e.accessTokenUrl),e.client_id&&(c=e.client_id),e.client_secret&&(i=e.client_secret),e.proxyUrl&&(r=e.proxyUrl),e.queryUrl&&(s=e.queryUrl),e.useQueryUrl&&(a=e.useQueryUrl);const l="xx-space-",u="token",f="access_token";function h(){location.href=t+"?client_id="+c+"&scope="+n}function d(e,t){localStorage.setItem(l+e,t)}function p(e){localStorage.removeItem(l+e)}function g(e,t){var n=window.location.search.substring(1);null!=t&&(n=t);for(var o=n.split("&"),c=0;c<o.length;c++){var i=o[c].split("=");if(i[0]==e)return i[1]}return!1}function m(e){if(!/access_token/.test(e))return alert("登录错误"),void x();d(f,e),d(u,g("access_token",e))}function x(){p(f),p(u)}function y(){return e=u,localStorage.getItem(l+e);var e}async function _(){return i&&!a?async function(){let e=g("code"),t={client_id:c,client_secret:i,code:e};if(e){const e=await fetch(r+o,{method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"},mode:"cors"});return m(await e.text()),y()}}():async function(){let e=g("code"),t={client_id:c,client_secret:i,code:e};if(e){const e=await fetch(s,{method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"},mode:"cors"});return m(await e.text()),y()}}()}function k(){return!!g("code")}function b(){return!!y()}return{login:h,isNext:k,next:_,getToken:y,hasToken:b,logout:x,auto:function(){if(b())return Promise.resolve(y());if(k()){return _()}return h(),Promise.resolve("登录页面")}}}n.d(t,{O:function(){return o}})},27420:function(e,t,n){"use strict";n.r(t);n(74916),n(4723);var o=n(74803),c=n(97076),i=n(20718),r=n(67294),s=n(60405),a=(0,i.Pi)((function(){var e=(0,o.m)().userStore;function t(){var t;t=location.href.match(/localhost/)?e.client_id_local:e.client_id,(0,s.O)({proxyUrl:"http://message.xiongxiao.me/cors/",client_id:t}).auto().then(console.log)}return(0,c.Z)((function(){(0,s.O)({proxyUrl:"http://message.xiongxiao.me/cors/"}).logout(),t()})),window.login=t,r.createElement("div",null,"登陆页面",r.createElement("a",{onClick:t},"登录"))}));t.default=a}}]);