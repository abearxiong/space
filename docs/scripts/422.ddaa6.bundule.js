(self.webpackChunkspace=self.webpackChunkspace||[]).push([[422],{65422:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});n(82526),n(57327),n(89554),n(21249),n(38880),n(49337),n(47941),n(54747),n(59495);var r=n(83107),i=(n(28385),n(60404)),o=(n(89113),n(4107)),a=(n(26281),n(79734)),l=n(87757),s=n.n(l),c=(n(63672),n(48086)),u=n(59713),d=n.n(u),m=(n(35666),n(48926)),A=n.n(m),f=n(63038),p=n.n(f),h=n(67294),g=n(20718),b=n(93379),_=n.n(b),E=n(74643),v={insert:"head",singleton:!1},C=(_()(E.Z,v),E.Z.locals||{}),x=n(74981),y=(n(79411),n(76588),n(50963)),w=n(86945),k=n(74803),Z=n(97076),P=n(16550),O=n(53824),q=(n(41817),n(83116),n(9676)),F=(n(42670),n(88335)),S=n(43712),G={insert:"head",singleton:!1},j=(_()(S.Z,G),S.Z.locals||{}),D=(0,g.Pi)((function(){var e=(0,k.m)().labelsStore;return h.createElement(q.Z.Group,{name:"issue-label",onChange:function(t){e.setLabelCheck(t)},value:e.labelCheck},h.createElement(F.ZP,{className:j.SpaceList,itemLayout:"horizontal",dataSource:e.pageData,split:!1,renderItem:function(e,t){var n=e.node;return h.createElement(F.ZP.Item,{title:n.description},h.createElement(q.Z,{name:"issue-label",value:n.id}),n.name)}}))})),L=n(51851),W=n(68949),B=n(38536);n(92222);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=(0,g.Pi)((function(){var e=(0,y.cI)(),t=p()(e,1)[0],n=(0,P.TH)(),l=(0,P.k6)(),u=(0,h.useRef)(null),d=(0,k.m)(),m=d.userStore,f=(d.editStore,d.labelsStore),g=d.issuesStore,b=(0,h.useState)(),_=p()(b,2),E=_[0],v=_[1],q=(0,h.useState)(!1),F=p()(q,2),S=F[0],G=F[1];(0,h.useEffect)((function(){if(u&&u.current){var e=u.current.editor;if(e.getSession().setUseWrapMode(!0),e.setShowPrintMargin(!1),E)e.setValue(E.body),t.setFieldsValue({title:E.title});else if("abearxiong"===m.userData.name||"熊潇"===m.userData.name){var n=(r=new Date,i=Math.floor((r.getTime()-1443365529298)/864e5)+1,o=r.getDay(),"奇幻旅程".concat(i," ").concat(["星期天","星期一","星期二","星期三","星期四","星期五","星期六"][o]));t.setFieldsValue({title:n})}}var r,i,o}),[u,E]),(0,Z.Z)((function(){var e=n.state;e&&j(e.index),f.getPageData()}));var j=function(){var e=A()(s().mark((function e(t){var n,r,i,o,a,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=m.client)){e.next=12;break}return e.next=5,n.query({query:O.Z,variables:M(M({},m.variables),{},{number:t,first:100,after:null})});case 5:r=e.sent,i=r.data,o=r.loading,a=i.repository.issue,v(a),a.labels&&(l=a.labels.edges.map((function(e){return e.node.id})),f.setLabelCheck(l)),o&&c.ZP.loading("加载中");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=h.createElement(x.ZP,{ref:u,placeholder:"Your Markdown",mode:"markdown",theme:"xcode",name:"ace-edit-content",onLoad:function(){},onChange:function(e){},fontSize:14,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!0,style:{width:"100%",height:"100%",overflowX:"hidden"},setOptions:{minLines:10,showLineNumbers:!0,highlightActiveLine:!0,tabSize:4}}),N=function(){var e=A()(s().mark((function e(t){var n,r,i,o,a,u,d,A,p,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null==E?void 0:E.id,null!==(n=null==E?void 0:E.state)&&void 0!==n?n:"OPEN",i=(0,W.ZN)(f.labelCheck),m.userRepository.canWrite||(i=null),i&&0===i.length&&(i=null),o=t.body,a=t.title,u=m.client,d=r?L.Z:B.Z,A=M(M({},m.variables),{},{id:r,title:a,body:o,labelIds:i}),!u){e.next=24;break}return e.next=22,u.mutate({mutation:d,variables:A});case 22:(p=e.sent).data&&(c.ZP.success("提交成功"),h={node:M({},p.data.createIssue.issue)},g.addPage(h),setTimeout((function(){l.push("/")}),1e3));case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=h.createElement(a.Z,{className:C.Form,form:t,onValuesChange:function(e){},onFinish:N,requiredMark:!1},h.createElement("div",{style:{display:"flex"}},h.createElement(a.Z.Item,{label:"标题",name:"title",style:{flexGrow:1},rules:[{required:!0}]},h.createElement(o.Z,{placeholder:"请填写标题"})),h.createElement(i.Z,{type:"primary",onClick:function(){t.submit()},style:{marginRight:10}},"提交"),h.createElement(i.Z,{type:"text",icon:h.createElement(w.Z,null),style:{marginRight:10},onClick:function(){return G(!0)}}),h.createElement(r.Z,{title:"其他设置",placement:"right",closable:!1,onClose:function(){return G(!1)},visible:S,getContainer:!1,width:500,style:{position:"absolute"}},h.createElement(D,null))),h.createElement(a.Z.Item,{name:"body",rules:[{required:!0}]},I));return h.createElement("div",{className:C.Edit},R)}))},74643:function(e,t,n){"use strict";var r=n(94015),i=n.n(r),o=n(23645),a=n.n(o)()(i());a.push([e.id,".Edit__Edit___1dFdg{height:100%;display:flex;flex-direction:column}.Edit__Form___3Gkqg{display:flex;flex-grow:1;flex-direction:column;position:relative;overflow:hidden}.Edit__Form___3Gkqg .ant-form-item{margin-bottom:1px}.Edit__Form___3Gkqg>div:nth-child(2){flex-grow:1}.Edit__Form___3Gkqg>div:nth-child(2) .ant-form-item-control-input{flex-grow:1}.Edit__Form___3Gkqg>div:nth-child(2) .ant-form-item-control-input .ant-form-item-control-input-content{flex-grow:1;height:100%}.Edit__Form___3Gkqg>div:nth-child(2) .ace_scrollbar .ace_scrollbar-h{height:0px;margin-top:-20px}.Edit__Form___3Gkqg>div:nth-child(2) .ace_scrollbar .ace_scrollbar-v{width:1px}","",{version:3,sources:["webpack://./src/pages/edit/Edit.scss"],names:[],mappings:"AAAA,oBACE,WAAA,CACA,YAAA,CACA,qBAAA,CAEF,oBACE,YAAA,CACA,WAAA,CACA,qBAAA,CAEA,iBAAA,CACA,eAAA,CAGE,mCACE,iBAAA,CAGJ,qCACE,WAAA,CAEE,kEACE,WAAA,CACA,uGACE,WAAA,CACA,WAAA,CAGJ,qEACE,UAAA,CACA,gBAAA,CAEF,qEACE,SAAA",sourcesContent:[".Edit {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.Form {\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n\n  position: relative;\n  overflow: hidden;\n\n  :global {\n    .ant-form-item {\n      margin-bottom: 1px;\n    }\n  }\n  > div:nth-child(2) {\n    flex-grow: 1;\n    :global {\n      .ant-form-item-control-input {\n        flex-grow: 1;\n        .ant-form-item-control-input-content {\n          flex-grow: 1;\n          height: 100%;\n        }\n      }\n      .ace_scrollbar .ace_scrollbar-h {\n        height: 0px; // 22px\n        margin-top: -20px;\n      }\n      .ace_scrollbar .ace_scrollbar-v {\n        width: 1px;\n      }\n    }\n  }\n}\n"],sourceRoot:""}]),a.locals={Edit:"Edit__Edit___1dFdg",Form:"Edit__Form___3Gkqg"},t.Z=a},43712:function(e,t,n){"use strict";var r=n(94015),i=n.n(r),o=n(23645),a=n.n(o)()(i());a.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=a}}]);